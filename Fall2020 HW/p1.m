%% problem 1
y = [1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,0,1,0,0,0,0,1,0,1,0,1,0,1,0,0,1,1,1,0,0,1];
v = [3.7, 3.5, 1.25, 0.75, 0.8, 0.7, 0.6, 1.1, 0.9, 0.9, 0.8, 0.55, 0.6, 1.4, 0.75, 2.3, 3.2, 0.85, 1.7, 1.8, 0.4, 0.95, 1.35, 1.5, 1.6, 0.6, 1.8, 0.95, 1.9, 1.6, 2.7, 2.35, 1.1, 1.1, 1.2, 0.8, 0.95, 0.75, 1.3];
r= [0.825, 1.09, 2.5, 1.5, 3.2, 3.5, 0.75, 1.7, 0.75, 0.45, 0.57, 2.75, 3, 2.33, 3.75, 1.64, 1.6, 1.415, 1.06, 1.8, 2, 1.36, 1.35, 1.36, 1.78, 1.5, 1.5, 1.9, 0.95, 0.4, 0.75, 0.3, 1.83, 2.2, 2, 3.33, 1.9, 1.9, 1.625];

x1 = log(10*v);
x2 = log(10*r);

X = [x1' x2'];
Xdes =[ones(size(y')) x1' x2'];
n = length(y');
alpha = 0.05; %alpha for CIs

[b,dev,stats] = glmfit(X,y','binomial','logit');
logitFit = glmval(b,X,'logit');

% get betas
b

% prediction
xnew = [log(10*1.5) log(10*1.5)];
ypred = 1 / (1 + exp(-(b(1)+b(2)*xnew(1)+b(3)*xnew(2))))

% probit
[bp,devp,statsp] = glmfit(X,y','binomial','probit');
dev
devp