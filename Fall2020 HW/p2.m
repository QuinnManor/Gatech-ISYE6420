%% problem2
% (a)
heights = [13.2	12.4	12.8	17.2	13	14	14.2	21.6	15	20	16	12.6	14.8	13	14	23.6	14	17	22.2	24.4	7.8	14.4	20	15.8	17	27	19.6	18	20.2	23.2	21	14.8	19.1	15.8	18	26	21.1	22	25	18.2];
gbu = [50	50	50	50	50	50	50	50	50	50	100	100	100	100	100	100	100	100	100	100	200	200	200	200	200	200	200	200	200	200	400	400	400	400	400	400	400	400	400	400];
[p,table,stats] = anova1(heights, gbu,'on');
stats
%    gnames: {4Ã—1 cell}
%         n: [10 10 10 10]
%    source: 'anova1'
%     means: [15.3400 17.1600 18.3000 20.1000]
%        df: 36
%         s: 4.2106
fcrit = finv(0.95,3,36)
% fcrit = 2.8663
%(b)
m = stats.means
% 15.3400   17.1600   18.3000   20.1000
c = [1 -1 -1 1];
L = c(1)*m(1) + c(2)*m(2)+c(3)*m(3) + c(4)*m(4)
% L = -0.02
LL= m * c'
% LL = -0.02
stdL = stats.s * sqrt(c(1)^2/10+c(2)^2/10+c(3)^2/10+c(4)^2/10)
% stdL = 2.6630
t = LL/stdL
% t = -0.0075

% p-value
tcdf(t,36)
% 0.4970

%or 95% confidence interval for population contrast
[LL - tinv(0.975, 20)*stdL, LL + tinv(0.975, 20)*stdL]
% -5.5750    5.5350